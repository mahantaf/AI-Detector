# An Empirical Study on Automatically Detecting AI-Generated Source Code: How Far Are We?


To see our results click on the `Results.xlsx` in the repository files list.

Infomration regarding our prompts can be found in `LLM_Prompts.pdf` file.

Static code metrics are available in `Static_Code_Metrics_Selected.pdf` file.

This repository includes the code and experimental data of a paper entitled "An Empirical Study on Automatically Detecting AI-Generated Source Code: How Far Are We?". This package includes the code for implmentation of 3 AI/Human Code Detector Tool namely:

1. Detection using ML Classification
2. Detection using Few-shot & Fine-tuning Gpt-3.5-turbo
3. Detection using Code Embedding



### Selected Code Metrics for ML with Code Metrics Approach
* 'AvgCountLine'
* 'AvgCountLineBlank'
* 'AvgCountLineCode'
* 'AvgCountLineComment'
* 'AvgCyclomatic'
* 'CountDeclClass'
* 'CountDeclExecutableUnit'
* 'CountDeclFunction'
* 'CountLine'
* 'CountLineBlank'
* 'CountLineCode'
* 'CountLineCodeDecl'
* 'CountLineCodeExe'
* 'CountLineComment'
* 'CountStmt'
* 'CountStmtDecl'
* 'CountStmtExe'
* 'Cyclomatic'
* 'MaxCyclomatic'
* 'MaxNesting'
* 'RatioCommentToCode'
* 'SumCyclomatic'
* 'variables'
* 'methods'
* 'method_signatures'
* 'operators'
* 'keywords'
* 'arguments'
* 'if_else_while_operators'
* 'If_else_while_names'


### Prompts for LLM-based Approach
#### LLM-based Approach - Prompts used

**Zero-shot Learning**


**Code-only**
> You will be provided with a {lang} source code. Please determine if the source code is generated by Artificial intelligence (AI) models (i.e. language models) or human. If the code is generated by human, output 1. If the code is generated by AI, output 0. Return the label only in the output.Determine whether this code is generated by human or AI and return the label. Code: {code}


**AST-only**
> You will be provided with a {lang} abstract syntax tree (AST). Please determine if the source code of the given AST is generated by Artificial intelligence (AI) models (i.e. language models) or human. If the code is generated by human, output 1. If the code is generated by AI, output 0. Return the label only in the output. Determine whether the source code is generated by human or AI and return the label. AST: {AST}


**Code+AST**
> You will be provided with a {lang} source code and its abstract syntax tree (AST). Please determine if the source code is generated by Artificial intelligence (AI) models (i.e. language models) or human. Take both source code and AST into account when making decisions. If the code is generated by human, output 1. If the code is generated by AI, output 0. Return the label only in the output. Determine whether the source code is generated by human or AI and return the label.Code: {code} AST: {AST}






#### In-context Learning


**Code-only**
***
> You will be provided with a {lang} source code. Please determine if the code snippet is generated by Artificial intelligence (AI) models (i.e. language models) or human. If the code is generated by human, output 1. If the code is generated by AI, output 0. A few example source code along with their corresponding labels are also provided. Return only the label in the output. Input: {Code} -> Output: 1 Input: {Code} -> Output: 1 Input: {Code} -> Output: 0 Input: {Code} -> Output: 0 Input: {Code} -> Output:


**AST-only**
> You will be provided with a {lang} abstract syntax tree (AST). Please determine if the source code of the given AST is generated by Artificial intelligence (AI) models (i.e. language models) or human. If the code is generated by human, output 1. If the code is generated by AI, output 0. A few example source code along with their corresponding labels are also provided. Return only the label in the output. Input: {AST} -> Output: 1 Input: {AST} -> Output: 1 Input: {AST} -> Output: 0 Input: {AST} -> Output: 0 Input: {AST} -> Output:


**Code+AST**
> You will be provided with a {lang} source code and its abstract syntax tree (AST). Please determine if the source code is generated by Artificial intelligence (AI) models (i.e. language models) or human.  If the code is generated by human, output 1. If the code is generated by AI, output 0. A few example source code along with their corresponding labels are also provided. Return only the label in the output. Input: {Code / AST} -> Output: 1 Input: {Code / AST} -> Output: 1 Input: {Code / AST} -> Output: 0 Input: {Code / AST} -> Output: 0 Input: {Code / AST} -> Output:








#### Fine-tuning


**Code-only**
> You will be provided with a {lang} source code. Please determine if the source code is generated by Artificial intelligence (AI) models (i.e. language models) or human. If the code is generated by human, output 1. If the code is generated by AI, output 0. Return the label only in the output. Determine whether this code is generated by human or AI and return the label. Code: {code}




**AST-only**
> You will be provided with a {lang} abstract syntax tree (AST). Please determine if the source code of the given AST is generated by Artificial intelligence (AI) models (i.e. language models) or human. If the code is generated by human, output 1. If the code is generated by AI, output 0. Return the label only in the output. Determine whether the source code is generated by human or AI and return the label. AST: {AST}


**Code+AST**
> You will be provided with a {lang} source code and its abstract syntax tree (AST). Please determine if the source code is generated by Artificial intelligence (AI) models (i.e. language models) or human. Take both source code and AST into account when making decisions. If the code is generated by human, output 1. If the code is generated by AI, output 0. Return the label only in the output. Determine whether the source code is generated by human or AI and return the label. Code: {code} AST: {AST}
